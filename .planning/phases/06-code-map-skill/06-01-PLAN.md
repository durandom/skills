---
phase: 06-code-map-skill
plan: 01
type: execute
---

<objective>
Create skill scaffold with format specification reference.

Purpose: Establish the skill structure and document the complete format spec that all other components depend on.
Output: Working SKILL.md router with comprehensive format-spec.md reference.
</objective>

<execution_context>
@.claude/skills/create-plans/workflows/execute-phase.md
@.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/phases/06-code-map-skill/BRIEF.md
@.planning/phases/06-code-map-skill/ROADMAP.md
@.claude/skills/create-agent-skills/SKILL.md
@.claude/skills/create-agent-skills/templates/router-skill.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create skill directory structure</name>
  <files>.claude/skills/code-map/</files>
  <action>
Create the complete skill directory structure:
```
.claude/skills/code-map/
├── SKILL.md
├── workflows/
├── templates/
├── scripts/
│   ├── __init__.py
│   └── tests/
│       └── __init__.py
└── references/
```
Create __init__.py files in scripts/ and scripts/tests/ for Python package structure.
  </action>
  <verify>ls -la .claude/skills/code-map/ shows all directories</verify>
  <done>All directories exist with proper structure</done>
</task>

<task type="auto">
  <name>Task 2: Create format specification reference</name>
  <files>.claude/skills/code-map/references/format-spec.md</files>
  <action>
Create comprehensive format specification covering:

1. **Zoom Levels** (L0-L3):
   - L0: ARCHITECTURE.md (500 line limit, system-wide)
   - L1: domains/*.md (300 line limit, major subsystems)
   - L2: modules/*.md (200 line limit, components)
   - L3: Source files (actual code, no docs)

2. **Anchors** (in headings, for grep navigation):
   - Format: `## [Lx:identifier] Title`
   - Example: `## [L1:auth] Authentication Domain`
   - Rules: lowercase, hyphens, alphanumeric only
   - Grep pattern: `grep "\[L1:auth\]"` finds the section
   - Not a link, just a marker in heading text

3. **Cross-references** (standard markdown links):
   - Format: `[Descriptive Text](relative/path.md)`
   - Example: `[Database Domain](database.md)`
   - Clickable in GitHub and all renderers
   - Validation: check target file exists

4. **Code references** (links with line numbers):
   - Format: `` [`symbol`](path/to/file.ext#L42) ``
   - Example: `` [`handle_login`](../src/auth/login.py#L42) ``
   - LSP resolves symbol to line number
   - Clickable in GitHub (jumps to exact line)
   - Code formatting distinguishes from prose links

5. **Size limits** (enforce abstraction):
   - Why limits matter
   - What to do when exceeded (split or summarize)

6. **Directory structure**:

   ```
   docs/map/
   ├── MAP.md              # Entry point
   ├── ARCHITECTURE.md     # L0
   └── domains/            # L1
       ├── domain-a.md
       └── domain-b.md
   ```

7. **Validation rules**:
   - All markdown links `[text](path.md)` must resolve to existing files
   - All code links `` [`symbol`](file#L42) `` must have valid file + line
   - LSP verifies symbol exists at specified line
   - No files exceed size limits

Use clear examples throughout. This is THE reference document for the format.
  </action>
  <verify>wc -l .claude/skills/code-map/references/format-spec.md shows reasonable length (150-300 lines)</verify>
  <done>Complete format specification with all sections and examples</done>
</task>

<task type="auto">
  <name>Task 3: Create SKILL.md router</name>
  <files>.claude/skills/code-map/SKILL.md</files>
  <action>
Create router-pattern SKILL.md with:

1. **YAML frontmatter**:
   - name: code-map
   - description: "Create and navigate hierarchical code maps for AI agent orientation. Use when bootstrapping understanding of a codebase, creating documentation for agent navigation, or validating map integrity."

2. **essential_principles** section:
   - Maps are hierarchical: L0 → L1 → L2 → L3
   - Machine-readable anchors enable grep navigation
   - Size limits enforce appropriate abstraction
   - Agents bootstrap by reading MAP.md first

3. **intake** section:
   - Present options: explore, create, validate
   - Wait for response

4. **routing** table:
   - explore → workflows/explore.md
   - create → workflows/create-map.md
   - validate → run scripts/validate_map.py directly

5. **reference_index** section:
   - List format-spec.md

6. **workflows_index** section:
   - List planned workflows with status (exists/todo)

Keep under 200 lines. Follow create-agent-skills patterns exactly.
  </action>
  <verify>cat .claude/skills/code-map/SKILL.md shows valid YAML frontmatter and XML structure</verify>
  <done>Valid router SKILL.md with intake, routing, and indices</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `ls -R .claude/skills/code-map/` shows complete structure
- [ ] SKILL.md has valid YAML frontmatter
- [ ] format-spec.md covers all format elements
- [ ] No markdown headings (#) in SKILL.md body (pure XML)
</verification>

<success_criteria>

- All tasks completed
- Skill structure matches router pattern
- Format spec is comprehensive and example-rich
- Ready for Plan 02 (templates)
</success_criteria>

<output>
After completion, create `.planning/phases/06-code-map-skill/06-01-SUMMARY.md`
</output>
